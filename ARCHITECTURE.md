# Jenkins Bootstrap Architecture

## Execution Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         setup.sh                            â”‚
â”‚                   (Main Orchestrator)                       â”‚
â”‚                                                             â”‚
â”‚  â€¢ Validates all scripts exist                             â”‚
â”‚  â€¢ Cleans up old temp files                                â”‚
â”‚  â€¢ Executes steps in sequence                              â”‚
â”‚  â€¢ Shows progress with colors                              â”‚
â”‚  â€¢ Handles failures gracefully                             â”‚
â”‚  â€¢ Displays success banner                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚                                  â”‚
                            â–¼                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚    Step 1: 01_install_dependencies.sh      â”‚                â”‚
â”‚                                            â”‚                â”‚
â”‚  âœ“ Detect OS (macOS/Linux)                â”‚                â”‚
â”‚  âœ“ Install Jenkins                         â”‚                â”‚
â”‚  âœ“ Install Java (OpenJDK)                  â”‚                â”‚
â”‚  âœ“ Install jq                              â”‚                â”‚
â”‚  âœ“ Start Jenkins service                   â”‚                â”‚
â”‚  âœ“ Export environment vars                 â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                            â”‚                                  â”‚
                            â”‚ (Success) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                            â–¼                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚    Step 2: 02_setup_security.sh            â”‚                â”‚
â”‚                                            â”‚                â”‚
â”‚  âœ“ Detect environment (EC2/Local)         â”‚                â”‚
â”‚  âœ“ Wait for Jenkins HTTP                  â”‚                â”‚
â”‚  âœ“ Download Jenkins CLI                   â”‚                â”‚
â”‚  âœ“ Create security groovy script          â”‚                â”‚
â”‚  âœ“ Create admin user (admin/admin)        â”‚                â”‚
â”‚  âœ“ Disable setup wizard                   â”‚                â”‚
â”‚  âœ“ Restart Jenkins                         â”‚                â”‚
â”‚  âœ“ Wait for CLI readiness                 â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                            â”‚                                  â”‚
                            â”‚ (Success) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                            â–¼                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚    Step 3: 03_install_plugins.sh           â”‚                â”‚
â”‚                                            â”‚                â”‚
â”‚  âœ“ Read plugins.txt                        â”‚                â”‚
â”‚  âœ“ Install all plugins via CLI            â”‚                â”‚
â”‚  âœ“ Trigger safe-restart                   â”‚                â”‚
â”‚  âœ“ Wait for HTTP readiness                â”‚                â”‚
â”‚  âœ“ Wait for CLI readiness                 â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                            â”‚                                  â”‚
                            â”‚ (Success) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                            â–¼                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚    Step 4: 04_setup_credentials.sh         â”‚                â”‚
â”‚                                            â”‚                â”‚
â”‚  âœ“ Create AWS credentials groovy script   â”‚                â”‚
â”‚  âœ“ Execute with retry logic (6 attempts)  â”‚                â”‚
â”‚  âœ“ 10-second timeout per attempt          â”‚                â”‚
â”‚  âœ“ Create placeholder credentials          â”‚                â”‚
â”‚     (ID: aws-creds, Keys: DUMMY/DUMMY)    â”‚                â”‚
â”‚  âœ“ Cleanup temp files                     â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                            â”‚                                  â”‚
                            â”‚ (Success/Warning) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                            â–¼                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚    Step 5: 05_create_jobs.sh               â”‚                â”‚
â”‚                                            â”‚                â”‚
â”‚  âœ“ Validate jobs/ directory                â”‚                â”‚
â”‚  âœ“ Get CSRF crumb token                   â”‚                â”‚
â”‚  âœ“ For each *.xml file:                   â”‚                â”‚
â”‚    â€¢ Check if job exists                  â”‚                â”‚
â”‚    â€¢ Create new OR update existing        â”‚                â”‚
â”‚  âœ“ Show summary (Created/Updated/Failed)  â”‚                â”‚
â”‚  âœ“ Cleanup cookies                        â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                            â”‚                                  â”‚
                            â”‚ (Success) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    âœ… SUCCESS BANNER                         â”‚
â”‚                                                             â”‚
â”‚  â€¢ Display Jenkins URL                                     â”‚
â”‚  â€¢ Display credentials                                     â”‚
â”‚  â€¢ Show next steps                                         â”‚
â”‚  â€¢ Cleanup temp files                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Shared Utilities (utils.sh)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            utils.sh                      â”‚
â”‚                                          â”‚
â”‚  Functions available to all scripts:    â”‚
â”‚                                          â”‚
â”‚  ğŸ“ Logging:                             â”‚
â”‚    â€¢ log_info()      â†’ Blue â–¶           â”‚
â”‚    â€¢ log_success()   â†’ Green âœ…          â”‚
â”‚    â€¢ log_warning()   â†’ Yellow âš ï¸         â”‚
â”‚    â€¢ log_error()     â†’ Red âŒ            â”‚
â”‚                                          â”‚
â”‚  â³ Waiting:                             â”‚
â”‚    â€¢ wait_for_jenkins_http()            â”‚
â”‚    â€¢ wait_for_jenkins_cli()             â”‚
â”‚                                          â”‚
â”‚  ğŸ” Detection:                           â”‚
â”‚    â€¢ detect_environment()               â”‚
â”‚                                          â”‚
â”‚  ğŸ”„ Control:                             â”‚
â”‚    â€¢ restart_jenkins(reason)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²          â–²          â–²
         â”‚          â”‚          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    Sourced by all step scripts
```

## Error Handling

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Any Step Fails â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  setup.sh catches exit code â‰  0     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Display error banner               â”‚
â”‚  Show which step failed             â”‚
â”‚  Suggest retry command              â”‚
â”‚  Exit with code 1                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## File System Layout

```
dvm-setup/
â”‚
â”œâ”€â”€ setup.sh â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Main entry point (run this!)
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ utils.sh â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Shared functions
â”‚   â”œâ”€â”€ 01_install_dependencies.sh
â”‚   â”œâ”€â”€ 02_setup_security.sh
â”‚   â”œâ”€â”€ 03_install_plugins.sh
â”‚   â”œâ”€â”€ 04_setup_credentials.sh
â”‚   â””â”€â”€ 05_create_jobs.sh
â”‚
â”œâ”€â”€ jobs/
â”‚   â”œâ”€â”€ Git_Code.xml
â”‚   â”œâ”€â”€ deploy-infra.xml
â”‚   â”œâ”€â”€ deploy-app.xml
â”‚   â”œâ”€â”€ deploy-monitoring.xml
â”‚   â””â”€â”€ destroy-infra.xml
â”‚
â”œâ”€â”€ plugins.txt â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Plugin list
â”‚
â”œâ”€â”€ README.md â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Main documentation
â”œâ”€â”€ SCRIPTS_REFERENCE.md â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Detailed script docs
â”œâ”€â”€ MIGRATION_GUIDE.md â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º What changed & why
â””â”€â”€ ARCHITECTURE.md â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º This file (visual guide)
```
